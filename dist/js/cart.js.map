{"version":3,"sources":["cart.js"],"names":["$","init","getCartdata","eventList","on","toggleClass","hasClass","text","editCart","deleteCart","$lis","length","mui","toast","createObj","order_price","consignee_addr","goods","i","li","before_obj","data","tmpObj","goods_id","goods_number","find","val","goods_price","push","token","JSON","parse","sessionStorage","getItem","ajax","url","type","headers","Authorization","success","result","meta","status","confirm","editType","index","location","href","res","cart_info","html","template","goodsObj","numbox","additionAll","total","tempObj","tempPrice","tmp_num","paramsObj","amount","infos","stringify","msg","lisss","console","log","parents","$unLis","not"],"mappings":"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","sourcesContent":["/* \r\n  1 任何人都可以访问这个购物车页面吗   登录过后的用户 才可以访问\r\n    1 判断 本地存储中有没有  userinfo 这个数据  有 登录过\r\n      假如 没有数据 \r\n        1 把当前的页面路径存入到 本地存储中 pageurl\r\n        2 跳转到登录页面\r\n  2 发送请求渲染数据 私人的数据  token  请求头 \r\n    1 token  本地存储 复杂类型\r\n    2 对象也是可以循环\r\n\r\n  3 计算总价 \r\n    1 页面打开的时候就计算总价格\r\n    2 点击数字输入框的时候 也是需要计算总价\r\n      1 绑定点击事件\r\n      2 点击触发 再调用 刚才 计算总价的方法\r\n  4 页面状态的改变\r\n    0 想 通过给body标签添加一个class 来控制 下面的标签的显示和隐藏   $(\"body\").toggleClass(\"edit_status\");\r\n      1 当body标签 没有 class  \"edit_status\"  以下标签就隐藏\r\n      2 当body标签 有 class  “edit_status”   以下标签就显示\r\n    1 一开始 复选框。数字输入框，删除按钮 都是隐藏\r\n    2 点击 编辑按钮的时候 以上的标签 反复切换 显示 \r\n  5 编辑购物车功能 \r\n    0 判断购物车有没有数据\r\n    1 明确 我们可以编辑的只有 购买的数量而已 \r\n    2 分析 接口的数据  发送到后台的数据  格式 是和 获取购物车的数据 的格式 完全一样！！！\r\n        但是 需要修改一个属性 amount ==  购买的数量\r\n    3 构造数据的逻辑\r\n      1 获取到所有的li标签\r\n      2 获取到所有的li标签身上的 商品对象\r\n      3 把获取到的商品的对象中的字段 amount 动态做改变 变成 数字输入框的值\r\n      4 把每一个商品对象 拼接成一个大对象 \r\n    4 发送请求 完成编辑 \r\n      1 post 需要带上参数  请求头\r\n      2 成功之后\r\n        1 弹出 同步成功的 提示\r\n        2 js 刷新一下数据 再调用一次  cartAll\r\n   6 删除功能 和编辑功能一样 都是使用 同步接口 \r\n    0 判断购物车有没有选中要删除的商品\r\n    1 分析 接口的数据  把 要删除的数据  不要发送到后台去！！！\r\n    2 把 未被复选框选中的数据 发送到后台去 该格式 和 编辑的时候的格式一致！！！\r\n    3 绑定 删除 按钮的点击事件\r\n      1 获取 未被选中的 li标签\r\n      2 循环\r\n      3 获取到 li标签的 身上 商品对象\r\n      4 把商品对象的 购买数量 又 修改成 数字输入框里面的值\r\n      5 拼接成给一个 大 对象\r\n      6 发送请求 完成同步\r\n    7 编辑和删除功能\r\n      1 只有 要操作的数据 li标签不一样  \r\n      2 剩下的逻辑 完全一样！！！！\r\n    8 生成订单的分析\r\n      1 判断有没有商品\r\n      2 获取所有的li标签\r\n      3 循环\r\n      4 循环内部开始构造 goods数据\r\n      5 在循环的外部 拼接完成 整个接口的参数\r\n      6 发送请求 完成 创建订单 (当购物车的商品变成了订单之后，刷新购物车页面，再也看不到购物车中的数据 )\r\n   */\r\n$(function () {\r\n\r\n  init();\r\n  function init() {\r\n    getCartdata()\r\n    eventList();\r\n\r\n  }\r\n  // 事件绑定\r\n  function eventList() {\r\n    // 编辑按钮点击事件\r\n    $('.edit_btn').on('tap', function () {\r\n      $(\"body\").toggleClass('edit_status');\r\n\r\n      if ($(\"body\").hasClass(\"edit_status\")) {\r\n        $(this).text(\"完成\");\r\n      } else {\r\n        $(this).text(\"编辑\");\r\n        editCart();\r\n      }\r\n    })\r\n    // 删除按钮\r\n    $('.del_btn').on('tap',function(){\r\n      deleteCart()\r\n    })\r\n\r\n     // 生成订单\r\n     $(\".create_btn\").on(\"tap\",function () {\r\n      // 8.1 获取li标签\r\n      let $lis=$(\".list li\");\r\n      if($lis.length==0){\r\n        mui.toast(\"您还没有选购商品\");\r\n        return;\r\n      }\r\n\r\n      // 构造接口要的参数\r\n      let createObj={\r\n        // 总价格\r\n        order_price:$(\".total_price\").text(),\r\n        // 订单地址\r\n        consignee_addr:\"p城\",\r\n        goods:[\r\n\r\n        ]\r\n      };\r\n      // 8.2 循环\r\n      for (let i = 0; i < $lis.length; i++) {\r\n        // 获取li标签身上的 商品对象\r\n        let li=$lis[i];\r\n        let before_obj=$(li).data(\"obj\");\r\n          // 临时的商品对象\r\n          let tmpObj={};\r\n          tmpObj.goods_id=before_obj.goods_id;\r\n          // 购买的数量\r\n          tmpObj.goods_number=$(li).find(\".mui-numbox-input\").val();\r\n          // 单价\r\n          tmpObj.goods_price=before_obj.goods_price;\r\n          // 添加到大的对象只能给\r\n          createObj.goods.push(tmpObj);\r\n      }\r\n\r\n      // 8.6 发送请求 完成 创建订单\r\n      let token = JSON.parse(sessionStorage.getItem(\"userinfo\")).token;\r\n  \r\n      $.ajax({\r\n        url:\"http://api.pyg.ak48.xyz/api/public/v1/my/orders/create\",\r\n        type:\"post\",\r\n        data:createObj,\r\n        headers:{\r\n          Authorization: token\r\n        },\r\n        success:function (result) {\r\n          if(result.meta.status==200){\r\n            // 创建成功\r\n            mui.confirm(\"要不要跳转到订单页面\",\"创建成功\",[\"跳转\",\"取消\"],function (editType) {\r\n              if(editType.index==0){\r\n                // 跳转\r\n                location.href=\"order.html\";\r\n              }else if(editType.index==1){\r\n                // 取消\r\n              }\r\n              \r\n            })\r\n          }else{\r\n            // 创建失败\r\n          }\r\n          \r\n        }\r\n      })\r\n      \r\n    })\r\n\r\n    \r\n\r\n\r\n  }\r\n\r\n  // 获取数据渲染页面\r\n  function getCartdata() {\r\n\r\n    let { token } = JSON.parse(sessionStorage.getItem('userinfo'));\r\n    $.ajax({\r\n      // type: \"get\",\r\n      url: \"http://api.pyg.ak48.xyz/api/public/v1/my/cart/all\",\r\n      // data: \"data\",\r\n      // dataType: \"json\",\r\n      // 注意请求头的写法\r\n      headers: {\r\n        Authorization: token\r\n      },\r\n      success: function (res) {\r\n        if (res.meta.status == 200) {\r\n          // 以前循环的数据都是数组 但是现在 是对象\r\n          // 数组可以循环 对象可以循环\r\n          // 要传递给模板引擎的数据\r\n          // 因为cart_info里的数据是字符串来的，需要转化\r\n          let cart_info = JSON.parse(res.data.cart_info);\r\n          let html = template('mainTpl', { goodsObj: cart_info });\r\n          $('.list').html(html)\r\n\r\n          // 数字输入框的初始化\r\n          mui(\".mui-numbox\").numbox();\r\n\r\n          additionAll();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  // 计算购物车总价格\r\n  function additionAll() {\r\n    /* \r\n    0 把每一种 商品的信息 提前放入到 li标签的自定义属性中，方便后期的获取 \r\n      修改一下 模板引擎的代码 \r\n    1 获取 所有的li标签 里面   商品信息对象\r\n    2 对li标签的商品信息对象数组 进行循环\r\n    3 在循环中\r\n      1 每一种商品的单价 * 该商品的数量(数字输入框里面的值)\r\n      2 需要叠加之后的总价格 渲染到页面的对应的标签上 \r\n    */\r\n\r\n    // 1获取所有的li标签\r\n    let $lis = $('.list li');\r\n\r\n    // 定义总价\r\n    let total = 0;\r\n\r\n    for (let i = 0; i < $lis.length; i++) {\r\n      // 获取到每一里的原生dom对象\r\n      let li = $lis[i];\r\n      // 获取商品上的信息对象\r\n      let tempObj = $(li).data(\"obj\");\r\n      // 再获取商品的价格\r\n      let tempPrice = tempObj.goods_price;\r\n      // 获取要购买的商品的数量\r\n      let tmp_num = $(li).find(\".mui-numbox-input\").val();\r\n\r\n      total += tempPrice * tmp_num;\r\n    }\r\n    // 把总价格 赋值到对应的标签上\r\n    // console.log(total);\r\n    $(\".total_price\").text(total);\r\n  }\r\n  // 编辑购物车\r\n  function editCart() {\r\n    // 1获取所有的li标签\r\n    let $lis = $('.list li');\r\n\r\n    if ($lis.length == 0) {\r\n      mui.toast(\"您还没有选购商品\");\r\n      return;\r\n    }\r\n    // 需要发送到后台的 对象\r\n    let paramsObj = {};\r\n\r\n    for (let i = 0; i < $lis.length; i++) {\r\n      // 获取到每一里的原生dom对象\r\n      let li = $lis[i];\r\n      // 获取商品上的信息对象\r\n      let tempObj = $(li).data(\"obj\");\r\n\r\n      // 获取要购买的商品的数量赋值到tempObj上\r\n      tempObj.amount = $(li).find(\".mui-numbox-input\").val();\r\n\r\n      // 给大的对象 赋值\r\n      paramsObj[tempObj.goods_id] = tempObj;\r\n    }\r\n    let token = JSON.parse(sessionStorage.getItem('userinfo')).token;\r\n    $.ajax({\r\n      type: \"post\",\r\n      url: \"http://api.pyg.ak48.xyz/api/public/v1/my/cart/sync\",\r\n      data: {\r\n        infos: JSON.stringify(paramsObj)\r\n      },\r\n      headers: {\r\n        Authorization: token\r\n      },\r\n      // dataType: \"json\",\r\n      success: function (res) {\r\n        if (res.meta.status == 200) {\r\n          // 同步成功，重新执行页面渲染函数\r\n          mui.toast(\"同步成功\");\r\n          getCartdata();\r\n        } else {\r\n          mui.toast(res.meta.msg);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  // 删除购物车\r\n  function deleteCart() {\r\n    // 0 获取被选中的li标签\r\n    let lisss = $('.list li');\r\n    console.log(lisss);\r\n    let $lis = $(\".list .ol_chk:checked\").parents(\"li\");\r\n    console.log($lis);\r\n\r\n    if ($lis.length == 0) {\r\n      mui.toast(\"您还没有选中要删除的商品\");\r\n      return;\r\n    }\r\n    // // console.log($lis);\r\n    // 1 获取未被选中的li标签\r\n    let $unLis = $(\".list .ol_chk\").not(\":checked\").parents(\"li\");\r\n\r\n\r\n    // 需要发送到后台的 对象\r\n    let paramsObj = {};\r\n    // 5.3.2 先循环\r\n    for (let i = 0; i < $unLis.length; i++) {\r\n      // 获取到单个的li标签 dom原生\r\n      let li = $unLis[i];\r\n      //  获取li标签身上的 商品对象 以前存放好的\r\n      let tmpObj = $(li).data(\"obj\");\r\n      // 把最新的购买的数量 赋值到 tmpObj上\r\n      tmpObj.amount = $(li)\r\n        .find(\".mui-numbox-input\")\r\n        .val();\r\n      // 给大的对象 赋值\r\n      paramsObj[tmpObj.goods_id] = tmpObj;\r\n    }\r\n    // 5.4 准备发送请求到后台 进行 编辑购物车\r\n    let token = JSON.parse(sessionStorage.getItem(\"userinfo\")).token;\r\n    $.ajax({\r\n      url: \"http://api.pyg.ak48.xyz/api/public/v1/my/cart/sync\",\r\n      type: \"post\",\r\n      data: {\r\n        infos: JSON.stringify(paramsObj)\r\n      },\r\n      headers: {\r\n        Authorization: token\r\n      },\r\n      success: function (result) {\r\n        // console.log(result);\r\n        if (result.meta.status == 200) {\r\n          // 成功\r\n          mui.toast(\"同步成功\");\r\n          getCartdata();\r\n        } else {\r\n          console.log(\"失败\", result);\r\n        }\r\n\r\n      }\r\n    })\r\n  }\r\n})\r\n\r\n"],"file":"cart.js"}