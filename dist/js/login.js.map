{"version":3,"sources":["login.js"],"names":["$","init","eventList","on","username","val","password","length","mui","toast","checkPhone","ajax","type","url","data","dataType","success","res","meta","status","sessionStorage","setItem","JSON","stringify","pageUrl","getItem","setTimeout","location","href","msg","phone","test"],"mappings":";;AACAA,CAAC,CAAC,YAAY;AACP;;;;;;;;;;;;;AAaHC,EAAAA,IAAI;;AACJ,WAASA,IAAT,GAAgB;AACZC,IAAAA,SAAS;AAEZ;;AAED,WAASA,SAAT,GAAqB;AACjBF,IAAAA,CAAC,CAAC,YAAD,CAAD,CAAgBG,EAAhB,CAAmB,KAAnB,EAAyB,YAAU;AAC/B,UAAIC,QAAQ,GAAGJ,CAAC,CAAC,sBAAD,CAAD,CAA0BK,GAA1B,EAAf;AACA,UAAIC,QAAQ,GAAGN,CAAC,CAAC,mBAAD,CAAD,CAAuBK,GAAvB,EAAf,CAF+B,CAG/B;;AACA,UAAIC,QAAQ,CAACC,MAAT,GAAkB,CAAtB,EAAyB;AACrBC,QAAAA,GAAG,CAACC,KAAJ,CAAU,QAAV;AACA;AACH;;AACD,UAAG,CAACC,UAAU,CAACN,QAAD,CAAd,EAAyB;AACrBI,QAAAA,GAAG,CAACC,KAAJ,CAAU,QAAV;AACA;AACH,OAX8B,CAa/B;;;AACAT,MAAAA,CAAC,CAACW,IAAF,CAAO;AACHC,QAAAA,IAAI,EAAE,MADH;AAEHC,QAAAA,GAAG,EAAE,6CAFF;AAGHC,QAAAA,IAAI,EAAE;AACFV,UAAAA,QAAQ,EAACA,QADP;AAEFE,UAAAA,QAAQ,EAACA;AAFP,SAHH;AAOHS,QAAAA,QAAQ,EAAE,MAPP;AAQHC,QAAAA,OAAO,EAAE,iBAAUC,GAAV,EAAe;AACpB,cAAGA,GAAG,CAACC,IAAJ,CAASC,MAAT,IAAmB,GAAtB,EAA0B;AACtB;AACA;AACAC,YAAAA,cAAc,CAACC,OAAf,CAAuB,UAAvB,EAAkCC,IAAI,CAACC,SAAL,CAAeN,GAAG,CAACH,IAAnB,CAAlC,EAHsB,CAKtB;;AACAN,YAAAA,GAAG,CAACC,KAAJ,CAAU,MAAV,EANsB,CAQtB;;AACA,gBAAIe,OAAO,GAAGJ,cAAc,CAACK,OAAf,CAAuB,SAAvB,CAAd,CATsB,CAWtB;;AACA,gBAAG,CAACD,OAAJ,EAAY;AACRA,cAAAA,OAAO,GAAG,YAAV;AACH,aAdqB,CAgBtB;;;AACAE,YAAAA,UAAU,CAAC,YAAM;AACbC,cAAAA,QAAQ,CAACC,IAAT,GAAgBJ,OAAhB;AACH,aAFS,EAEP,IAFO,CAAV;AAIH,WArBD,MAqBK;AACD;AACAhB,YAAAA,GAAG,CAACC,KAAJ,CAAUQ,GAAG,CAACC,IAAJ,CAASW,GAAnB;AACH;AACJ;AAlCE,OAAP;AAqCH,KAnDD;AAoDH,GAzES,CA4EV;;;AACA,WAASnB,UAAT,CAAoBoB,KAApB,EAA2B;AACvB,QAAI,CAAC,kBAAkBC,IAAlB,CAAuBD,KAAvB,CAAL,EAAoC;AAChC,aAAO,KAAP;AACH,KAFD,MAEO;AACH,aAAO,IAAP;AACH;AACJ;AACJ,CApFA,CAAD","sourcesContent":["\r\n$(function () {\r\n       /* \r\n    1 点击登录按钮\r\n      1 获取 用户名和密码\r\n      2 合法性的验证 不通过 弹窗 给提示 \r\n    2 构造参数  发送请求完成 登录\r\n      1 登录成功\r\n        1 把token存到本地存储中  既然要存数据 干脆 整个result.data 都存起来 方便后期 扩展使用\r\n        2 登录成功的提示 \r\n    3 登录成功\r\n      1 先判断有没有来源页面  存储在 sessionStorage key pageurl\r\n      2 有 就跳转到来源页面 \r\n      3 没有再跳转到 首页 index.html\r\n     */\r\n    init();\r\n    function init() {\r\n        eventList();\r\n\r\n    }\r\n\r\n    function eventList() {\r\n        $(\".login_btn\").on('tap',function(){\r\n            let username = $(\"input[name='mobile']\").val();\r\n            let password = $(\"input[name='pwd']\").val();\r\n            // 验证密码的合法性\r\n            if (password.length < 6) {\r\n                mui.toast(\"密码格式不对\");\r\n                return;\r\n            }\r\n            if(!checkPhone(username)){\r\n                mui.toast(\"手机格式不对\");\r\n                return;\r\n            }\r\n\r\n            // 2 构造参数  发送请求完成 登录\r\n            $.ajax({\r\n                type: \"post\",\r\n                url: \"http://api.pyg.ak48.xyz/api/public/v1/login\",\r\n                data: {\r\n                    username:username,\r\n                    password:password\r\n                },\r\n                dataType: \"json\",\r\n                success: function (res) {\r\n                    if(res.meta.status == 200){\r\n                        // 1 把token存到本地存储中  既然要存数据 干脆 整个result.data 都存起来 方便后期 扩展使用\r\n                        // res.data中有token属性\r\n                        sessionStorage.setItem('userinfo',JSON.stringify(res.data));\r\n\r\n                        // 提示\r\n                        mui.toast('登录成功');\r\n\r\n                        // 获取来源页面\r\n                        var pageUrl = sessionStorage.getItem('pageurl');\r\n\r\n                        // 如果无来源页面则跳转到主页\r\n                        if(!pageUrl){\r\n                            pageUrl = \"index.html\";\r\n                        }\r\n\r\n                        // 延迟跳转\r\n                        setTimeout(() => {\r\n                            location.href = pageUrl;\r\n                        }, 1000);\r\n\r\n                    }else{\r\n                        // 错误\r\n                        mui.toast(res.meta.msg)\r\n                    }\r\n                }\r\n            });\r\n            \r\n        })\r\n    }\r\n\r\n\r\n    // 验证 手机合法性\r\n    function checkPhone(phone) {\r\n        if (!/^1[34578]\\d{9}$/.test(phone)) {\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n    }\r\n})"],"file":"login.js"}