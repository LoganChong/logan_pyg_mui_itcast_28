{"version":3,"sources":["register.js"],"names":["$","init","eventList","on","mobile_txt","val","trim","checkPhone","mui","toast","post","mobile","res","meta","status","console","log","attr","time","timeId","setInterval","text","clearInterval","removeAttr","mobile_text","code_text","email_text","pwd_text","pwd2_text","gender_text","length","checkEmail","code","email","pwd","gender","setTimeout","location","href","msg","phone","test","myemail","myReg"],"mappings":"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","sourcesContent":["$(function () {\r\n    /* \r\n  1 绑定 获取验证码 tap事件\r\n    1 获取手机号码 进行合法性的验证\r\n      1 不通过 给出一个用户提示 就ok\r\n  2 构造参数 发送请求到后台   成功了\r\n    1 禁用按钮   $(this).attr(\"disabled\",\"disabled\");\r\n    2 开启定时器 倒计时 60s\r\n      1 修改按钮的文字 定时的时间\r\n    3 时间到了 \r\n      1 清除定时器\r\n      2 重新启用 按钮\r\n  3 绑定注册点击事件\r\n    1 获取一坨值 表单一些值\r\n    2 挨个验证\r\n      1 不通过弹出对话框 提示\r\n    3 构造参数 发送请求到后台 完成注册\r\n      1 注册失败  手机号码已经被注册过了 弹出一个提示 \r\n    4 注册成功\r\n      1 弹出一个提示 恭喜用户 你进坑。。\r\n      2 跳转页面 登录页面\r\n   */\r\n    init();\r\n    function init() {\r\n        eventList();\r\n    }\r\n    function eventList() {\r\n        $('.get_code_btn').on('tap', function () {\r\n            let mobile_txt = $(\"input[name='mobile']\").val().trim();\r\n\r\n            if (!checkPhone(mobile_txt)) {\r\n                // 1.2 弹出一个提示\r\n                mui.toast(\"手机号码错误\");\r\n                return;\r\n            }\r\n\r\n            //  2 构造参数发送到后台\r\n            $.post(\r\n                \"http://api.pyg.ak48.xyz/api/public/v1/users/get_reg_code\",\r\n                { mobile: mobile_txt },\r\n                function (res) {\r\n                    if (res.meta.status == 200) {\r\n                        console.log(res);\r\n                        // 1 禁用按钮\r\n                        $(\".get_code_btn\").attr(\"disabled\", \"disabled\");\r\n                        // 2 开启定时器 倒计时 60s\r\n                        // 1 修改按钮的文字 定时的时间\r\n                        let time = 60;\r\n                        let timeId = setInterval(() => {\r\n                            time--;\r\n                            $(\".get_code_btn\").text(`${time} 秒后重新发送`);\r\n                            if (time == 0) {\r\n                                clearInterval(timeId);\r\n                                $(\".get_code_btn\").removeAttr('disabled').text('获取验证码')\r\n                            }\r\n                        }, 1000);\r\n                    } else {\r\n                        console.log('获取失败')\r\n                    }\r\n                })\r\n        });\r\n        // 绑定 点击注册 的按钮 事件\r\n        $('.register_btn').on('tap', function () {\r\n            // 3.1 获取一堆值\r\n            let mobile_text = $(\"input[name='mobile']\").val().trim();\r\n            let code_text = $(\"input[name='code']\").val().trim();\r\n            let email_text = $(\"input[name='email']\").val().trim();\r\n            let pwd_text = $(\"input[name='pwd']\").val().trim();\r\n            let pwd2_text = $(\"input[name='pwd2']\").val().trim();\r\n            let gender_text = $(\"input[name='gender']:checked\").val().trim();\r\n            // 需要注意性别gender这个值，如果未加：checked这个筛选，则获取不到值，\r\n            // 还需要在html中将val的值加上，这样才能获取到值，gender参数在后台应该是必填项\r\n            // 3.2 按个验证\r\n            // 验证手机号码\r\n            if (!checkPhone(mobile_text)) {\r\n                //  失败\r\n                // 1.2 弹出一个提示\r\n                mui.toast(\"手机号码错误\");\r\n\r\n                return;\r\n            }\r\n            // 验证 验证码的长度 不等于  4 就是错误\r\n            if (code_text.length != 4) {\r\n                mui.toast(\"验证码不合法\");\r\n                return;\r\n            }\r\n            // 验证邮箱的合法性\r\n            if (!checkEmail(email_text)) {\r\n                mui.toast(\"邮箱不合法\");\r\n                return;\r\n            }\r\n            // 验证密码的合法性\r\n            if (pwd_text.length < 6) {\r\n                mui.toast(\"密码格式不对\");\r\n                return;\r\n            }\r\n            // 验证 重复密码\r\n            if (pwd2_text != pwd_text) {\r\n                mui.toast(\"两次密码不一致！\");\r\n                return;\r\n            }\r\n            // 3.3 构造参数 完成注册\r\n            $.post(\r\n                \"http://api.pyg.ak48.xyz/api/public/v1/users/reg\",\r\n                {\r\n                    mobile: mobile_text,\r\n                    code: code_text,\r\n                    email: email_text,\r\n                    pwd: pwd_text,\r\n                    gender: gender_text\r\n                }, function (res) {\r\n                    console.log(res);\r\n                    if (res.meta.status == 200) {\r\n                        mui.toast('注册成功')\r\n                        setTimeout(() => {\r\n                            location.href = 'login.html'\r\n                        }, 1000)\r\n                    } else {\r\n                        mui.toast(res.meta.msg);\r\n                    }\r\n\r\n                });\r\n        });\r\n\r\n    }\r\n\r\n    // 验证 手机合法性\r\n    function checkPhone(phone) {\r\n        if (!/^1[34578]\\d{9}$/.test(phone)) {\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n    }\r\n    // 验证 邮箱\r\n    function checkEmail(myemail) {\r\n        var myReg = /^[a-zA-Z0-9_-]+@([a-zA-Z0-9]+\\.)+(com|cn|net|org)$/;\r\n        if (myReg.test(myemail)) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n})"],"file":"register.js"}